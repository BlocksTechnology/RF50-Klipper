[gcode_macro CLEAN_NOZZLE]
variable_start_x: -14
variable_start_y: 80
variable_start_y_2: 100
variable_wipe_dist: 45
variable_wipe_qty: 15
variable_wipe_spd: 200
variable_raise_distance: 20
variable_plate_wipe_x: -1
variable_plate_wipe_y: 10
variable_plate_wipe_y_2: 50
variable_plate_wipe_qty: 5
gcode:
    HOME_IF_NEEDED
    RESTORE_DEFAULT_BOUNDARY
    SET_HEATER_TEMPERATURE HEATER=extruder TARGET=220
    TEMPERATURE_WAIT SENSOR=extruder MINIMUM=215 MAXIMUM=240
    M400
    SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
    G90                                            ; absolute positioning
    # Move nozzle to start position
    G1 X{start_x-(start_x)} Y{start_y} F12000
    G1 X{start_x} Y{start_y} F12000
    G92 E0
    G1 E-1
    G92 E0
    SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
    SET_FAN_SPEED FAN=Part_Cooling_Fan SPEED=1.0
    {% for wipes in range(1, (wipe_qty + 1)) %}
      G1 X{start_x} Y{start_y_2 + wipe_dist} F{wipe_spd * 60}
      G1 Y{start_y_2} F{wipe_spd * 60}
    {% endfor %}
    # Now Slower
    {% for wipes in range(1, (wipe_qty + 1)) %}
      G1 X{start_x} Y{start_y_2 + wipe_dist} F{50 * 60}
      G1 Y{start_y_2} F{100 * 60}
    {% endfor %}
    G92 E0
    G1 E-2
    G92 E0
    G0 X{plate_wipe_x} Y{plate_wipe_y} Z0.16 F{50 * 60}
    {% for wipes in range (1, (plate_wipe_qty + 1)) %}
      G0 X{plate_wipe_x} Y{plate_wipe_y_2 + 80 } F{100 * 60}
      G0 Y{plate_wipe_y_2} F{100 * 60}
    {% endfor %}
    # Slower
    {% for wipes in range (1, (plate_wipe_qty + 1)) %}
      G0 X{plate_wipe_x} Y{plate_wipe_y_2 + 80} F{100 * 60}
      G0 Y{plate_wipe_y_2} F{100 * 60}
    {% endfor %}
    SET_FAN_SPEED FAN=Part_Cooling_Fan SPEED=0.0
    SET_CUSTOM_BOUNDARY MOVE_TO_PARK=False
    G0 Z5 F{15 * 60}
    G4 P10
    M400
